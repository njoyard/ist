/**
 * IST: Indented Selector Templating
 * version 0.5.7
 *
 * Copyright (c) 2012-2013 Nicolas Joyard
 * Released under the MIT license.
 *
 * Author: Nicolas Joyard <joyard.nicolas@gmail.com>
 * http://njoyard.github.com/ist
 */

!function(e){var n,t,l="function"==typeof e.define&&e.define.amd,r="undefined"!=typeof process&&process.versions&&!!process.versions.node,u="undefined"!=typeof window&&window.navigator&&window.document;t={require:e.require},t.context=function(){function e(e,n){this.value=e,this.doc=n||document,this.scopes=[{document:this.doc}],"undefined"!=typeof e&&this.scopes.push(e)}return e.prototype={importNode:function(e,n){return this.doc.importNode(e,n)},createDocumentFragment:function(){return this.doc.createDocumentFragment()},createElement:function(e,n){return"undefined"!=typeof n?this.doc.createElementNS(n,e):this.doc.createElement(e)},createTextNode:function(e){return this.doc.createTextNode(e)},istData:function(e){return e._ist_data=e._ist_data||{},e._ist_data},pushScope:function(e){this.scopes.unshift(e)},popScope:function(){if(this.scopes.length<3)throw new Error("No scope left to pop out");return this.scopes.shift()},pushEvalVar:function(e,n){var t={};t[e]=n,this.pushScope(t)},popEvalVar:function(e){var n=this.scopes[0];if("undefined"==typeof n[e]||Object.keys(n).length>1)throw new Error("Cannot pop variable, does not match topmost scope");return this.popScope()[e]},evaluate:function(e){var n,t="return "+e+";",l=[];return this.scopes.forEach(function(e,n){l.push("scope"+n),t="with(scope"+n+"){\n"+t+"\n}"}),n=new Function(l.join(","),t),n.apply(this.value,this.scopes)},interpolate:function(e){return e.replace(/{{((?:}(?!})|[^}])*)}}/g,function(e,n){return this.evaluate(n)}.bind(this))},createContext:function(n){return new e(n,this.doc)}},e}(),t.directives=function(){function e(e,n,t,l){n&&l.appendChild(t.render(e))}function n(e,n,t,l,r){var u=e.value;n.forEach(function(i,o){var f=e.createContext(i),c={first:0===o,index:o,last:o==n.length-1,length:n.length,outer:u};t&&Object.keys(t).forEach(function(e){c[e]=t[e]}),f.pushScope({loop:c}),r.appendChild(l.render(f))})}var t,l,r={};return l={"if":function(n,t,l,r){e.call(null,n,t.value,l,r)},unless:function(n,t,l,r){e.call(null,n,!t.value,l,r)},"with":function(e,n,t,l){l.appendChild(t.render(n))},each:function(e,t,l,r){var u=t.value;if(!Array.isArray(u))throw new Error(u+" is not an array");n(e,u,null,l,r)},eachkey:function(e,t,l,r){var u,i=t.value;u=Object.keys(i).map(function(e){return{key:e,value:i[e]}}),n(e,u,{object:i},l,r)},dom:function(e,n,t,l){var r=n.value;r.ownerDocument!==n.doc&&(r=n.doc.importNode(r)),l.appendChild(r)},define:function(e,n,t){r[n.value]=t},use:function(e,n,t,l){var u=n.value,i=r[u];if(!i)throw new Error("Template '"+u+"' has not been @defined");l.appendChild(i.render(e))}},t={register:function(e,n){l[e]=n},get:function(e){return l[e]}}}(),t.renderer=function(e){function n(e,n){this.template=e,this.context=n}return n.prototype._completeError=function(e,n){return this.template._completeError(e,n)},n.prototype._renderTextNode=function(e){var n,t=this.context;if("undefined"!=typeof e.pr)n=t.importNode(e.pr,!1);else try{n=t.createTextNode(t.interpolate(e.text))}catch(l){throw this._completeError(l,e)}return n},n.prototype._renderElement=function(e){var n,t=this.context;return"undefined"!=typeof e.pr?n=t.importNode(e.pr,!1):(n=t.createElement(e.tagName),e.classes.forEach(function(e){n.classList.add(e)}),"undefined"!=typeof e.id&&(n.id=e.id)),Object.keys(e.attributes).forEach(function(l){var r;try{r=t.interpolate(e.attributes[l])}catch(u){throw this._completeError(u,e)}n.setAttribute(l,r)},this),Object.keys(e.properties).forEach(function(l){var r;try{r=t.interpolate(e.properties[l])}catch(u){throw this._completeError(u,e)}n[l]=r},this),Object.keys(e.events).forEach(function(l){e.events[l].forEach(function(r){var u;try{u=t.evaluate(r)}catch(i){throw this._completeError(i,e)}n.addEventListener(l,u,!1)},this)},this),n},n.prototype._renderDirective=function(n){var t,l=this.context,r=this.template,u=r.constructor,i=new u(r.name,n.children),o=e.get(n.directive),f=l.createDocumentFragment();if("function"!=typeof o)throw new Error("No directive helper for @"+n.directive+" has been registered");if("undefined"!=typeof n.expr)try{t=l.createContext(l.evaluate(n.expr))}catch(c){throw this._completeError(c,n)}try{o.call(null,l,t,i,f)}catch(c){throw this._completeError(c,n)}return f},n.prototype.renderRec=function(e){var n;return this.context,"undefined"!=typeof e.text&&(n=this._renderTextNode(e)),"undefined"!=typeof e.tagName&&(n=this._renderElement(e),e.children.map(this.renderRec,this).forEach(function(e){n.appendChild(e)})),"undefined"!=typeof e.directive&&(n=this._renderDirective(e)),n},n.prototype.render=function(){var e=this.context.createDocumentFragment();return this.template.nodes.map(this.renderRec,this).forEach(function(n){e.appendChild(n)}),e},n}(t.directives),t.template=function(e,n){function t(e,n){var l,r,u,i=n.filter(function(n){return n.partial===e});if(i.length)return i[0];for(r=0,u=n.length;u>r;r++)if("undefined"!=typeof n[r].children&&(l=t(e,n[r].children)))return l}function l(e,n){this.name=e||"<unknown>",this.nodes=n,this.nodes.forEach(r)}function r(e){var n;"undefined"==typeof e.text||u.test(e.text)||(e.pr=document.createTextNode(e.text)),"undefined"!=typeof e.tagName&&(e.pr=n=document.createElement(e.tagName),e.classes.forEach(function(e){n.classList.add(e)}),"undefined"!=typeof e.id&&(n.id=e.id)),"undefined"!=typeof e.children&&e.children.forEach(r)}var u=/{{((?:}(?!})|[^}])*)}}/;return l.prototype._completeError=function(e,n){var t="in '"+this.name+"' on line "+(n.line||"<unknown>");return"undefined"==typeof e.istStack&&(e.message+=" "+t,e.istStack=[]),e.istStack.push(t),e},l.prototype.findPartial=function(e){var n;if("undefined"!=typeof e)return n=t(e,this.nodes),"undefined"!=typeof n?new l(this.name,[n]):void 0},l.prototype.render=function(t,l){return t instanceof e?l=t.doc:t=new e(t,l),new n(this,t).render()},l.prototype.getCode=function(e){return"new ist.Template("+JSON.stringify(this.name)+", "+JSON.stringify(this.nodes,null,e?1:0)+");"},l}(t.context,t.renderer),t.parsehelpers=function(){var e,n,t,l="U",r="I",u="D",i={};return e=function(){return{text:this.text,line:this.line}},n=function(){var e={tagName:this.tagName,line:this.line,classes:this.classes,attributes:this.attributes,properties:this.properties,events:this.events,children:this.children};return"undefined"!=typeof this.id&&(e.id=this.id),"undefined"!=typeof this.partial&&(e.partial=this.partial),e},t=function(){return{directive:this.directive,expr:this.expr,line:this.line,children:this.children}},i.generateNodeTree=function(e,n){var t,i,o,f,c={children:[]},s=[c],a=0;if(!e)return c.children;for(i=function(){return s[s.length-1]},o=function(e){a++,s.push(e)},f=function(){var e;if(s.length<2)throw new Error("Could not pop node from stack");return e=s.pop(),i().children.push(e),e},t=n.map(function(e){return e.pop()}),t.unshift(e),t.forEach(function(e){var n,t=e.indent,c=e.item,s=e.num;if(t[0]instanceof Error)throw t[0];if(a>0)if(t[0]===l)f();else if(t[0]===u)for(f();t.length>0;)t.pop(),f();else if(t[0]===r&&"undefined"!=typeof i().text)throw n=new Error("Cannot add children to text node"),n.line=s,n;o(c)});s.length>1;)f();return c.children},i.parseIndent=function(e,n,t){var i,o=n.length,f=[];if(0===o.length&&e.push(o),o==e[0])return[l];if(o>e[0])return e.unshift(o),[r];for(;o<e[0];)e.shift(),f.push(u);return o!=e[0]?(i=new Error("Unexpected indent"),i.line=t,i.column=1,[i]):f},i.createTextNode=function(n,t){return{text:n,line:t,toJSON:e}},i.createElement=function(e,t,l,r){var u={tagName:e,line:r,classes:[],attributes:{},properties:{},events:{},children:[],toJSON:n};return t.forEach(function(e){"undefined"!=typeof e.id?u.id=e.id:"undefined"!=typeof e.className?u.classes.push(e.className):"undefined"!=typeof e.attr?u.attributes[e.attr]=e.value:"undefined"!=typeof e.prop?u.properties[e.prop]=e.value:"undefined"!=typeof e.event&&("undefined"==typeof u.events[e.event]&&(u.events[e.event]=[]),u.events[e.event].push(e.value))}),"undefined"!=typeof l&&(l.partial.length>0&&(u.partial=l.partial),"undefined"!=typeof l.textnode&&"undefined"!=typeof l.textnode.text&&u.children.push(l.textnode)),u},i.createDirective=function(e,n,l){return{directive:e,expr:n,line:l,children:[],toJSON:t}},i.escapedCharacter=function(e){return e.length>1?String.fromCharCode(parseInt(e,16)):{f:"\f",b:"\b",t:"	",n:"\n",r:"\r"}[e]||e},i}(),t.parser=function(e){var n;return n=function(){function n(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,l){function r(e){var n={};for(var t in e)n[t]=e[t];return n}function u(e,n){for(var l=e.offset+n,r=e.offset;l>r;r++){var u=t.charAt(r);"\n"===u?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===u||"\u2028"===u||"\u2029"===u?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}e.offset+=n}function i(e){H.offset<I.offset||(H.offset>I.offset&&(I=r(H),J=[]),J.push(e))}function o(){var n,t,l,u,i,o,f,s;for(o=r(H),f=r(H),n=[],t=a();null!==t;)n.push(t),t=a();if(null!==n)if(t=c(),t=null!==t?t:"",null!==t){if(l=[],s=r(H),i=a(),null!==i)for(u=[];null!==i;)u.push(i),i=a();else u=null;for(null!==u?(i=c(),null!==i?u=[u,i]:(u=null,H=r(s))):(u=null,H=r(s));null!==u;){if(l.push(u),s=r(H),i=a(),null!==i)for(u=[];null!==i;)u.push(i),i=a();else u=null;null!==u?(i=c(),null!==i?u=[u,i]:(u=null,H=r(s))):(u=null,H=r(s))}if(null!==l){for(u=[],i=a();null!==i;)u.push(i),i=a();null!==u?n=[n,t,l,u]:(n=null,H=r(f))}else n=null,H=r(f)}else n=null,H=r(f);else n=null,H=r(f);return null!==n&&(n=function(n,t,l,r,u){return e.generateNodeTree(r,u)}(o.offset,o.line,o.column,n[1],n[2])),null===n&&(H=r(o)),n}function f(){var e;return M++,/^[ \t]/.test(t.charAt(H.offset))?(e=t.charAt(H.offset),u(H,1)):(e=null,0===M&&i("[ \\t]")),M--,0===M&&null===e&&i("whitespace"),e}function c(){var e,n,t,l,u,i;if(u=r(H),i=r(H),e=s(),null!==e)if(n=w(),null===n&&(n=S(),null===n&&(n=D())),null!==n){for(t=[],l=f();null!==l;)t.push(l),l=f();null!==t?e=[e,n,t]:(e=null,H=r(i))}else e=null,H=r(i);else e=null,H=r(i);return null!==e&&(e=function(e,n,t,l,r){return{indent:l,item:r,num:n}}(u.offset,u.line,u.column,e[0],e[1])),null===e&&(H=r(u)),e}function s(){var n,t,l;for(M++,l=r(H),n=[],t=f();null!==t;)n.push(t),t=f();return null!==n&&(n=function(n,t,l,r){return e.parseIndent(X,r,t)}(l.offset,l.line,l.column,n)),null===n&&(H=r(l)),M--,0===M&&null===n&&i("indent"),n}function a(){var e;return M++,10===t.charCodeAt(H.offset)?(e="\n",u(H,1)):(e=null,0===M&&i('"\\n"')),M--,0===M&&null===e&&i("new line"),e}function d(){var e;return M++,/^[^\n]/.test(t.charAt(H.offset))?(e=t.charAt(H.offset),u(H,1)):(e=null,0===M&&i("[^\\n]")),M--,0===M&&null===e&&i("character"),e}function p(){var e,n,l,o,f;if(M++,o=r(H),f=r(H),/^[a-z_]/i.test(t.charAt(H.offset))?(e=t.charAt(H.offset),u(H,1)):(e=null,0===M&&i("[a-z_]i")),null!==e){for(n=[],/^[a-z0-9_\-]/i.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i("[a-z0-9_\\-]i"));null!==l;)n.push(l),/^[a-z0-9_\-]/i.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i("[a-z0-9_\\-]i"));null!==n?e=[e,n]:(e=null,H=r(f))}else e=null,H=r(f);return null!==e&&(e=function(e,n,t,l,r){return l+r.join("")}(o.offset,o.line,o.column,e[0],e[1])),null===e&&(H=r(o)),M--,0===M&&null===e&&i("identifier"),e}function h(){var e,n,l,o;return l=r(H),o=r(H),33===t.charCodeAt(H.offset)?(e="!",u(H,1)):(e=null,0===M&&i('"!"')),null!==e?(n=p(),null!==n?e=[e,n]:(e=null,H=r(o))):(e=null,H=r(o)),null!==e&&(e=function(e,n,t,l){return l}(l.offset,l.line,l.column,e[1])),null===e&&(H=r(l)),e}function v(){var e,n,l,o;return l=r(H),o=r(H),35===t.charCodeAt(H.offset)?(e="#",u(H,1)):(e=null,0===M&&i('"#"')),null!==e?(n=p(),null!==n?e=[e,n]:(e=null,H=r(o))):(e=null,H=r(o)),null!==e&&(e=function(e,n,t,l){return{id:l}}(l.offset,l.line,l.column,e[1])),null===e&&(H=r(l)),e}function m(){var e,n,l,o;return l=r(H),o=r(H),46===t.charCodeAt(H.offset)?(e=".",u(H,1)):(e=null,0===M&&i('"."')),null!==e?(n=p(),null!==n?e=[e,n]:(e=null,H=r(o))):(e=null,H=r(o)),null!==e&&(e=function(e,n,t,l){return{className:l}}(l.offset,l.line,l.column,e[1])),null===e&&(H=r(l)),e}function y(){var e,n,l;for(l=r(H),e=[],n=j(),null===n&&(/^[^\\\n\]]/.test(t.charAt(H.offset))?(n=t.charAt(H.offset),u(H,1)):(n=null,0===M&&i("[^\\\\\\n\\]]")));null!==n;)e.push(n),n=j(),null===n&&(/^[^\\\n\]]/.test(t.charAt(H.offset))?(n=t.charAt(H.offset),u(H,1)):(n=null,0===M&&i("[^\\\\\\n\\]]")));return null!==e&&(e=function(e,n,t,l){return l.join("")}(l.offset,l.line,l.column,e)),null===e&&(H=r(l)),e}function g(){var e,n,l,o,f,c,s;return c=r(H),s=r(H),91===t.charCodeAt(H.offset)?(e="[",u(H,1)):(e=null,0===M&&i('"["')),null!==e?(n=p(),null!==n?(61===t.charCodeAt(H.offset)?(l="=",u(H,1)):(l=null,0===M&&i('"="')),null!==l?(o=y(),null!==o?(93===t.charCodeAt(H.offset)?(f="]",u(H,1)):(f=null,0===M&&i('"]"')),null!==f?e=[e,n,l,o,f]:(e=null,H=r(s))):(e=null,H=r(s))):(e=null,H=r(s))):(e=null,H=r(s))):(e=null,H=r(s)),null!==e&&(e=function(e,n,t,l,r){return{attr:l,value:r}}(c.offset,c.line,c.column,e[1],e[3])),null===e&&(H=r(c)),e}function x(){var e,n,l,o,f,c,s,a;return s=r(H),a=r(H),91===t.charCodeAt(H.offset)?(e="[",u(H,1)):(e=null,0===M&&i('"["')),null!==e?(46===t.charCodeAt(H.offset)?(n=".",u(H,1)):(n=null,0===M&&i('"."')),null!==n?(l=p(),null!==l?(61===t.charCodeAt(H.offset)?(o="=",u(H,1)):(o=null,0===M&&i('"="')),null!==o?(f=y(),null!==f?(93===t.charCodeAt(H.offset)?(c="]",u(H,1)):(c=null,0===M&&i('"]"')),null!==c?e=[e,n,l,o,f,c]:(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a)),null!==e&&(e=function(e,n,t,l,r){return{prop:l,value:r}}(s.offset,s.line,s.column,e[2],e[4])),null===e&&(H=r(s)),e}function A(){var e,n,l,o,f,c,s,a;return s=r(H),a=r(H),91===t.charCodeAt(H.offset)?(e="[",u(H,1)):(e=null,0===M&&i('"["')),null!==e?(33===t.charCodeAt(H.offset)?(n="!",u(H,1)):(n=null,0===M&&i('"!"')),null!==n?(l=p(),null!==l?(61===t.charCodeAt(H.offset)?(o="=",u(H,1)):(o=null,0===M&&i('"="')),null!==o?(f=y(),null!==f?(93===t.charCodeAt(H.offset)?(c="]",u(H,1)):(c=null,0===M&&i('"]"')),null!==c?e=[e,n,l,o,f,c]:(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a))):(e=null,H=r(a)),null!==e&&(e=function(e,n,t,l,r){return{event:l,value:r}}(s.offset,s.line,s.column,e[2],e[4])),null===e&&(H=r(s)),e}function E(){var e;return M++,e=v(),null===e&&(e=m(),null===e&&(e=g(),null===e&&(e=x(),null===e&&(e=A())))),M--,0===M&&null===e&&i("element qualifier"),e}function w(){var e;return M++,e=C(),null===e&&(e=N()),M--,0===M&&null===e&&i("element"),e}function C(){var n,t,l,u;if(l=r(H),u=r(H),t=E(),null!==t)for(n=[];null!==t;)n.push(t),t=E();else n=null;return null!==n?(t=b(),null!==t?n=[n,t]:(n=null,H=r(u))):(n=null,H=r(u)),null!==n&&(n=function(n,t,l,r,u){return e.createElement("div",r,u,t)}(l.offset,l.line,l.column,n[0],n[1])),null===n&&(H=r(l)),n}function N(){var n,t,l,u,i;if(u=r(H),i=r(H),n=p(),null!==n){for(t=[],l=E();null!==l;)t.push(l),l=E();null!==t?(l=b(),null!==l?n=[n,t,l]:(n=null,H=r(i))):(n=null,H=r(i))}else n=null,H=r(i);return null!==n&&(n=function(n,t,l,r,u,i){return e.createElement(r,u,i,t)}(u.offset,u.line,u.column,n[0],n[1],n[2])),null===n&&(H=r(u)),n}function b(){var e,n,t,l,u,i,o;if(l=r(H),u=r(H),i=r(H),o=r(H),n=f(),null!==n)for(e=[];null!==n;)e.push(n),n=f();else e=null;if(null!==e?(n=S(),null!==n?e=[e,n]:(e=null,H=r(o))):(e=null,H=r(o)),null!==e&&(e=function(e,n,t,l){return l}(i.offset,i.line,i.column,e[1])),null===e&&(H=r(i)),e=null!==e?e:"",null!==e){if(i=r(H),o=r(H),t=f(),null!==t)for(n=[];null!==t;)n.push(t),t=f();else n=null;null!==n?(t=h(),null!==t?n=[n,t]:(n=null,H=r(o))):(n=null,H=r(o)),null!==n&&(n=function(e,n,t,l){return l}(i.offset,i.line,i.column,n[1])),null===n&&(H=r(i)),n=null!==n?n:"",null!==n?e=[e,n]:(e=null,H=r(u))}else e=null,H=r(u);return null!==e&&(e=function(e,n,t,l,r){return{textnode:l,partial:r}}(l.offset,l.line,l.column,e[0],e[1])),null===e&&(H=r(l)),e}function S(){var n,t;return M++,t=r(H),n=z(),null!==n&&(n=function(n,t,l,r){return e.createTextNode(r,t)}(t.offset,t.line,t.column,n)),null===n&&(H=r(t)),M--,0===M&&null===n&&i("text node"),n}function _(){var e,n,l,o,f,c,s;return c=r(H),s=r(H),117===t.charCodeAt(H.offset)?(e="u",u(H,1)):(e=null,0===M&&i('"u"')),null!==e?(/^[0-9a-z]/i.test(t.charAt(H.offset))?(n=t.charAt(H.offset),u(H,1)):(n=null,0===M&&i("[0-9a-z]i")),null!==n?(/^[0-9a-z]/i.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i("[0-9a-z]i")),null!==l?(/^[0-9a-z]/i.test(t.charAt(H.offset))?(o=t.charAt(H.offset),u(H,1)):(o=null,0===M&&i("[0-9a-z]i")),null!==o?(/^[0-9a-z]/i.test(t.charAt(H.offset))?(f=t.charAt(H.offset),u(H,1)):(f=null,0===M&&i("[0-9a-z]i")),null!==f?e=[e,n,l,o,f]:(e=null,H=r(s))):(e=null,H=r(s))):(e=null,H=r(s))):(e=null,H=r(s))):(e=null,H=r(s)),null!==e&&(e=function(e,n,t,l,r,u,i){return""+l+r+u+i}(c.offset,c.line,c.column,e[1],e[2],e[3],e[4])),null===e&&(H=r(c)),e}function T(){var e,n,l,o,f;return o=r(H),f=r(H),120===t.charCodeAt(H.offset)?(e="x",u(H,1)):(e=null,0===M&&i('"x"')),null!==e?(/^[0-9a-z]/i.test(t.charAt(H.offset))?(n=t.charAt(H.offset),u(H,1)):(n=null,0===M&&i("[0-9a-z]i")),null!==n?(/^[0-9a-z]/i.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i("[0-9a-z]i")),null!==l?e=[e,n,l]:(e=null,H=r(f))):(e=null,H=r(f))):(e=null,H=r(f)),null!==e&&(e=function(e,n,t,l,r){return""+l+r}(o.offset,o.line,o.column,e[1],e[2])),null===e&&(H=r(o)),e}function j(){var n,l,o,f;return o=r(H),f=r(H),92===t.charCodeAt(H.offset)?(n="\\",u(H,1)):(n=null,0===M&&i('"\\\\"')),null!==n?(l=_(),null===l&&(l=T(),null===l&&(l=d())),null!==l?n=[n,l]:(n=null,H=r(f))):(n=null,H=r(f)),null!==n&&(n=function(n,t,l,r){return e.escapedCharacter(r)}(o.offset,o.line,o.column,n[1])),null===n&&(H=r(o)),n}function k(){var e,n,l,o,f;if(o=r(H),f=r(H),34===t.charCodeAt(H.offset)?(e='"',u(H,1)):(e=null,0===M&&i('"\\""')),null!==e){for(n=[],l=j(),null===l&&(/^[^\\\n"]/.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i('[^\\\\\\n"]')));null!==l;)n.push(l),l=j(),null===l&&(/^[^\\\n"]/.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i('[^\\\\\\n"]')));null!==n?(34===t.charCodeAt(H.offset)?(l='"',u(H,1)):(l=null,0===M&&i('"\\""')),null!==l?e=[e,n,l]:(e=null,H=r(f))):(e=null,H=r(f))}else e=null,H=r(f);return null!==e&&(e=function(e,n,t,l){return l.join("")}(o.offset,o.line,o.column,e[1])),null===e&&(H=r(o)),e}function O(){var e,n,l,o,f;if(o=r(H),f=r(H),39===t.charCodeAt(H.offset)?(e="'",u(H,1)):(e=null,0===M&&i('"\'"')),null!==e){for(n=[],l=j(),null===l&&(/^[^\\\n']/.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i("[^\\\\\\n']")));null!==l;)n.push(l),l=j(),null===l&&(/^[^\\\n']/.test(t.charAt(H.offset))?(l=t.charAt(H.offset),u(H,1)):(l=null,0===M&&i("[^\\\\\\n']")));null!==n?(39===t.charCodeAt(H.offset)?(l="'",u(H,1)):(l=null,0===M&&i('"\'"')),null!==l?e=[e,n,l]:(e=null,H=r(f))):(e=null,H=r(f))}else e=null,H=r(f);return null!==e&&(e=function(e,n,t,l){return l.join("")}(o.offset,o.line,o.column,e[1])),null===e&&(H=r(o)),e}function z(){var e;return M++,e=k(),null===e&&(e=O()),M--,0===M&&null===e&&i("quoted text"),e}function D(){var e;return M++,e=q(),null===e&&(e=R()),M--,0===M&&null===e&&i("directive"),e}function R(){var n,l,o,f;return o=r(H),f=r(H),64===t.charCodeAt(H.offset)?(n="@",u(H,1)):(n=null,0===M&&i('"@"')),null!==n?(l=p(),null!==l?n=[n,l]:(n=null,H=r(f))):(n=null,H=r(f)),null!==n&&(n=function(n,t,l,r){return e.createDirective(r,void 0,t)}(o.offset,o.line,o.column,n[1])),null===n&&(H=r(o)),n}function q(){var n,l,o,c,s,a,h;if(a=r(H),h=r(H),64===t.charCodeAt(H.offset)?(n="@",u(H,1)):(n=null,0===M&&i('"@"')),null!==n)if(l=p(),null!==l){if(c=f(),null!==c)for(o=[];null!==c;)o.push(c),c=f();else o=null;if(null!==o){if(s=d(),null!==s)for(c=[];null!==s;)c.push(s),s=d();else c=null;null!==c?n=[n,l,o,c]:(n=null,H=r(h))}else n=null,H=r(h)}else n=null,H=r(h);else n=null,H=r(h);return null!==n&&(n=function(n,t,l,r,u){return e.createDirective(r,u.join(""),t)}(a.offset,a.line,a.column,n[1],n[3])),null===n&&(H=r(a)),n}function L(e){e.sort();for(var n=null,t=[],l=0;l<e.length;l++)e[l]!==n&&(t.push(e[l]),n=e[l]);return t}var F={templateLines:o,__:f,line:c,indent:s,newline:a,character:d,identifier:p,partial:h,elemId:v,elemClass:m,squareBracketsValue:y,elemAttribute:g,elemProperty:x,elemEventHandler:A,elemQualifier:E,element:w,implicitElement:C,explicitElement:N,elementAdditions:b,textNode:S,escapedUnicode:_,escapedASCII:T,escapedCharacter:j,doubleQuotedText:k,singleQuotedText:O,quotedText:z,directive:D,simpleDirective:R,exprDirective:q};if(void 0!==l){if(void 0===F[l])throw new Error("Invalid rule name: "+n(l)+".")}else l="templateLines";var H={offset:0,line:1,column:1,seenCR:!1},M=0,I={offset:0,line:1,column:1,seenCR:!1},J=[],X=[0],P=F[l]();if(null===P||H.offset!==t.length){var $=Math.max(H.offset,I.offset),B=$<t.length?t.charAt($):null,U=H.offset>I.offset?H:I;throw new this.SyntaxError(L(J),B,$,U.line,U.column)}return P},toSource:function(){return this._source}};return t.SyntaxError=function(e,t,l,r,u){function i(e,t){var l,r;switch(e.length){case 0:l="end of input";break;case 1:l=e[0];break;default:l=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}return r=t?n(t):"end of input","Expected "+l+" but "+r+" found."}this.name="SyntaxError",this.expected=e,this.found=t,this.message=i(e,t),this.offset=l,this.line=r,this.column=u},t.SyntaxError.prototype=Error.prototype,t}()}(t.parsehelpers),t.preprocessor=function(){var e,n,t=/\r\n|\r|\n/,l=/^[ \t]*$/,r=/\/\*((?:\/(?!<\*)|[^\/])*?)\*\//g;return e=function(e,n){return n.split(t).map(function(){return""}).join("\n")},n=function(e){return e.match(l)?"":e},function(l){return l=l.replace(r,e),l=l.split(t).map(n).join("\n")}}(),t.misc=function(){return{jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\t]/g,"\\t").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},findScript:function(e){var n,t,l,r,u;try{u=document.querySelectorAll("script#"+e)}catch(i){return}if(u)for(n=0,t=u.length;t>n;n++)if(l=u[n],"text/x-ist"===l.getAttribute("type"))return l.innerHTML;return r}}}(),t.amdplugin=function(e,n){function t(t){var l,i,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],f={};if(u)l=function(){var e,n,t;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(n=0;3>n;n++){t=o[n];try{e=new ActiveXObject(t)}catch(l){}if(e){o=[t];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},i=function(e,n){var t=l();t.open("GET",e,!0),t.onreadystatechange=function(){if(4===t.readyState){if(200!==t.status)throw new Error("HTTP status "+t.status+" when loading "+e);n(t.responseText)}},t.send(null)};else if(r){var c=e.nodeRequire("fs");i=function(e,n){var t=c.readFileSync(e,"utf8");0===t.indexOf("ï»¿")&&(t=t.substring(1)),n(t)}}t.write=function(e,n,t){var l="ist!"+n;if(f.hasOwnProperty(l)){var r=f[l];t(r)}},t.load=function(e,l,r,u){var o,c,s=!0;/!bare$/.test(e)&&(s=!1,e=e.replace(/!bare$/,"")),o=l.toUrl(e+".ist"),c=-1===e.indexOf("/")?".":e.replace(/\/[^\/]*$/,""),i(o,function(i){var a,d=["ist"];i=i.replace(/^(\s*)@include\s+(?:text=)?(['"])((?:(?=(\\?))\4.)*?)\2/gm,function(e,t,l,r){if(n.findScript(r))return e;var u=c+"/"+r.replace(/\.ist$/,"");return-1===d.indexOf("ist!"+u)&&d.push("ist!"+u),t+'@include "'+u+'"'}),s?(a=t(i,e).getCode(!0),i="define('ist!"+e+"',"+JSON.stringify(d)+", function(ist) {\n"+"  return "+a+";\n"+"});\n"):u.isBuild?(i=n.jsEscape(i),i="define('ist!"+e+"',"+JSON.stringify(d)+",function(ist){"+"var template='"+i+"';"+"return ist(template,'"+e+"');"+"});"):(i=n.jsEscape(i).replace(/\\n/g,"\\n' +\n	               '"),i="define('ist!"+e+"',"+JSON.stringify(d)+", function(ist){ \n"+"	var template = '"+i+"';\n"+"	return ist(template, '"+e+"');\n"+"});\n"),u.isBuild&&(f["ist!"+e]=i),u.isBuild||(i+="\r\n//@ sourceURL="+o),r.fromText("ist!"+e,i),l(["ist!"+e],function(e){r(e)})})}}return t}(t.require,t.misc),t.ist=function(e,n,t,i,o,f){function c(n,l){var r;l=l||"<unknown>";try{r=t.parse(i(n))}catch(u){throw u.message+=" in '"+l+"' on line "+u.line+("undefined"!=typeof u.column?", character "+u.column:""),u}return new e(l,r)}return c.Template=e,c.createNode=function(e,n,t){var l,r=e.split(">").map(function(e){return e.trim()}),u="",i="";return r.forEach(function(e){i+="\n"+u+e,u+=" "}),l=c(i).render(n,t),1===l.childNodes.length?l.firstChild:l},c.fromScriptTag=function(e){var n=f.findScript(e);return n?c(n):void 0},c.registerHelper=function(e,t){n.register(e,t)},c.registerHelper("include",function(e,n,t,r){var u,i,o=n.value,s=o.replace(/\.ist$/,"");if(u=f.findScript(o),l)for(i=[s,s+".ist","ist!"+s,"text!"+s+".ist"];!u&&i.length;)try{u=requirejs(i.shift())}catch(a){}if(!u)throw new Error("Cannot find included template '"+o+"'");if("string"==typeof u&&(u=c(u,s)),"function"!=typeof u.render)throw new Error("Invalid included template '"+o+"'");r.appendChild(u.render(e))}),(r||u&&l)&&o(c),c}(t.template,t.directives,t.parser,t.preprocessor,t.amdplugin,t.misc),l?e.define("ist",[],function(){return t.ist}):(n=e.ist,e.ist=t.ist,e.ist.noConflict=function(){var t=e.ist;return e.ist=n,t})}(this);