/**
 * IST: Indented Selector Templating
 * version 0.5.7
 *
 * Copyright (c) 2012-2013 Nicolas Joyard
 * Released under the MIT license.
 *
 * Author: Nicolas Joyard <joyard.nicolas@gmail.com>
 * http://njoyard.github.com/ist
 */

!function(e){var n,t,r="function"==typeof e.define&&e.define.amd,l="undefined"!=typeof process&&process.versions&&!!process.versions.node,u="undefined"!=typeof window&&window.navigator&&window.document;t={require:e.require},t.context=function(){function e(e,n){this.value=e,this.doc=n||document,this.scopes=[{document:this.doc}],"undefined"!=typeof e&&this.scopes.push(e)}return e.prototype={importNode:function(e,n){return this.doc.importNode(e,n)},createDocumentFragment:function(){return this.doc.createDocumentFragment()},createElement:function(e,n){return"undefined"!=typeof n?this.doc.createElementNS(n,e):this.doc.createElement(e)},createTextNode:function(e){return this.doc.createTextNode(e)},istData:function(e){return e._ist_data=e._ist_data||{},e._ist_data},pushScope:function(e){this.scopes.unshift(e)},popScope:function(){if(this.scopes.length<3)throw new Error("No scope left to pop out");return this.scopes.shift()},pushEvalVar:function(e,n){var t={};t[e]=n,this.pushScope(t)},popEvalVar:function(e){var n=this.scopes[0];if("undefined"==typeof n[e]||Object.keys(n).length>1)throw new Error("Cannot pop variable, does not match topmost scope");return this.popScope()[e]},evaluate:function(e){var n,t="return "+e+";",r=[];return this.scopes.forEach(function(e,n){r.push("scope"+n),t="with(scope"+n+"){\n"+t+"\n}"}),n=new Function(r.join(","),t),n.apply(this.value,this.scopes)},interpolate:function(e){return e.replace(/{{((?:}(?!})|[^}])*)}}/g,function(e,n){return this.evaluate(n)}.bind(this))},createContext:function(n){return new e(n,this.doc)}},e}(),t.directives=function(){function e(e,n,t,r){n&&r.appendChild(t.render(e))}function n(e,n,t,r,l){var u=e.value;n.forEach(function(i,o){var f=e.createContext(i),s={first:0===o,index:o,last:o==n.length-1,length:n.length,outer:u};t&&Object.keys(t).forEach(function(e){s[e]=t[e]}),f.pushScope({loop:s}),l.appendChild(r.render(f))})}var t,r,l={};return r={"if":function(n,t,r,l){e.call(null,n,t.value,r,l)},unless:function(n,t,r,l){e.call(null,n,!t.value,r,l)},"with":function(e,n,t,r){r.appendChild(t.render(n))},each:function(e,t,r,l){var u=t.value;if(!Array.isArray(u))throw new Error(u+" is not an array");n(e,u,null,r,l)},eachkey:function(e,t,r,l){var u,i=t.value;u=Object.keys(i).map(function(e){return{key:e,value:i[e]}}),n(e,u,{object:i},r,l)},dom:function(e,n,t,r){var l=n.value;l.ownerDocument!==n.doc&&(l=n.doc.importNode(l)),r.appendChild(l)},define:function(e,n,t){l[n.value]=t},use:function(e,n,t,r){var u=n.value,i=l[u];if(!i)throw new Error("Template '"+u+"' has not been @defined");r.appendChild(i.render(e))}},t={register:function(e,n){r[e]=n},get:function(e){return r[e]}}}(),t.renderer=function(e){function n(e,n){this.template=e,this.context=n}return n.prototype._completeError=function(e,n){return this.template._completeError(e,n)},n.prototype._renderTextNode=function(e,n){var t=this.context,r=n.firstChild,l=!r;if("pr"in e)r||(r=t.importNode(e.pr,!1));else{r||(r=t.createTextNode(""));try{r.textContent=t.interpolate(e.text)}catch(u){throw this._completeError(u,e)}}l&&n.appendChild(r)},n.prototype._renderElement=function(e,n){var t=this.context,r=n.firstChild,l=!r;r||(r=t.importNode(e.pr,!1)),Object.keys(e.attributes).forEach(function(n){var l;try{l=t.interpolate(e.attributes[n])}catch(u){throw this._completeError(u,e)}r.setAttribute(n,l)},this),Object.keys(e.properties).forEach(function(n){var l;try{l=t.interpolate(e.properties[n])}catch(u){throw this._completeError(u,e)}r[n]=l},this),Object.keys(e.events).forEach(function(n){e.events[n].forEach(function(l){var u;try{u=t.evaluate(l)}catch(i){throw this._completeError(i,e)}r.addEventListener(n,u,!1)},this)},this),l&&n.appendChild(r)},n.prototype._renderDirective=function(n,t){var r,l=this.context,u=this.template,i=u.constructor,o=new i(u.name,n.children),f=e.get(n.directive);if("function"!=typeof f)throw new Error("No directive helper for @"+n.directive+" has been registered");if("undefined"!=typeof n.expr)try{r=l.createContext(l.evaluate(n.expr))}catch(s){throw this._completeError(s,n)}try{f.call(null,l,r,o,t)}catch(s){throw this._completeError(s,n)}},n.prototype._renderRec=function(e,n){"undefined"!=typeof e.text&&this._renderTextNode(e,n),"undefined"!=typeof e.tagName&&(this._renderElement(e,n),n.firstChild.appendChild(this._renderNodes(e.children))),"undefined"!=typeof e.directive&&this._renderDirective(e,this._extendFragment(n))},n.prototype._extendFragment=function(e){var n=this;return e.appendRenderedFragment=function(t,r){t.firstChild._istUpdate=t.update,"_istParent"in t||(t._istParent=e),n._pushNodes(t,r)},e.extractRenderedFragment=function(t){var r=n._pullNodes(e,t);return r.firstChild&&"_istRendered"in r.firstChild?(r.update=r.firstChild._istUpdate,delete r.firstChild._istUpdate,r):void 0},e},n.prototype._pullNodes=function(e,n){var t=[].slice.call(e.childNodes),r=this.context.createDocumentFragment();r._istParent=e;for(var l=0,u=t.length;u>l;l++){var i=t[l];i._istStack[0]===n&&("_istPrevious"in r||(r._istPrevious=i.previousSibling),i._istStack.shift(),r.appendChild(i))}return r},n.prototype._pushNodes=function(e,n){var t=e._istParent,r="_istPrevious"in e?e._istPrevious.nextSibling:null;[].slice.call(e.childNodes).forEach(function(e){e._istStack||(e._istStack=[]),e._istStack.unshift(n),t.insertBefore(e,r)})},n.prototype._renderNodes=function(e,n){var t=this;return n=n||this.context.createDocumentFragment(),e.forEach(function(e){var r=t._pullNodes(n,e);t._renderRec(e,r),t._pushNodes(r,e)}),n},n.prototype.render=function(e){return this._renderNodes(this.template.nodes,e)},n}(t.directives),t.template=function(e,n){function t(e,n){var r,l,u,i=n.filter(function(n){return n.partial===e});if(i.length)return i[0];for(l=0,u=n.length;u>l;l++)if("undefined"!=typeof n[l].children&&(r=t(e,n[l].children)))return r}function r(e,n){this.name=e||"<unknown>",this.nodes=n,this.nodes.forEach(l)}function l(e){var n;"undefined"==typeof e.text||u.test(e.text)||(e.pr=document.createTextNode(e.text)),"undefined"!=typeof e.tagName&&(e.pr=n=document.createElement(e.tagName),e.classes.forEach(function(e){n.classList.add(e)}),"undefined"!=typeof e.id&&(n.id=e.id)),"undefined"!=typeof e.children&&e.children.forEach(l)}var u=/{{((?:}(?!})|[^}])*)}}/;return r.prototype._completeError=function(e,n){var t="in '"+this.name+"' on line "+(n.line||"<unknown>");return"undefined"==typeof e.istStack&&(e.message+=" "+t,e.istStack=[]),e.istStack.push(t),e},r.prototype.findPartial=function(e){var n;if("undefined"!=typeof e)return n=t(e,this.nodes),"undefined"!=typeof n?new r(this.name,[n]):void 0},r.prototype.render=function(t,r){t instanceof e||(t=new e(t,r));var l=this,u=new n(l,t).render();return u.update=function(u){u instanceof e?t=u:u&&(t=new e(u,r));var i=this.update.nodes,o=i[0],f=o.parentNode,s=o.previousSibling,c=t.createDocumentFragment();i.forEach(function(e){c.appendChild(e)}),new n(l,t).render(c),this.update.nodes=[].slice.call(c.childNodes),f.insertBefore(c,s.nextSibling)},u.update.nodes=[].slice.call(u.childNodes),u},r.prototype.getCode=function(e){return"new ist.Template("+JSON.stringify(this.name)+", "+JSON.stringify(this.nodes,null,e?1:0)+");"},r}(t.context,t.renderer),t.parsehelpers=function(){var e,n,t,r="U",l="I",u="D",i={};return e=function(){return{text:this.text,line:this.line}},n=function(){var e={tagName:this.tagName,line:this.line,classes:this.classes,attributes:this.attributes,properties:this.properties,events:this.events,children:this.children};return"undefined"!=typeof this.id&&(e.id=this.id),"undefined"!=typeof this.partial&&(e.partial=this.partial),e},t=function(){return{directive:this.directive,expr:this.expr,line:this.line,children:this.children}},i.generateNodeTree=function(e,n){var t,i,o,f,s={children:[]},c=[s],a=0;if(!e)return s.children;for(i=function(){return c[c.length-1]},o=function(e){a++,c.push(e)},f=function(){var e;if(c.length<2)throw new Error("Could not pop node from stack");return e=c.pop(),i().children.push(e),e},t=n.map(function(e){return e.pop()}),t.unshift(e),t.forEach(function(e){var n,t=e.indent,s=e.item,c=e.num;if(t[0]instanceof Error)throw t[0];if(a>0)if(t[0]===r)f();else if(t[0]===u)for(f();t.length>0;)t.pop(),f();else if(t[0]===l&&"undefined"!=typeof i().text)throw n=new Error("Cannot add children to text node"),n.line=c,n;o(s)});c.length>1;)f();return s.children},i.parseIndent=function(e,n,t){var i,o=n.length,f=[];if(0===o.length&&e.push(o),o==e[0])return[r];if(o>e[0])return e.unshift(o),[l];for(;o<e[0];)e.shift(),f.push(u);return o!=e[0]?(i=new Error("Unexpected indent"),i.line=t,i.column=1,[i]):f},i.createTextNode=function(n,t){return{text:n,line:t,toJSON:e}},i.createElement=function(e,t,r,l){var u={tagName:e,line:l,classes:[],attributes:{},properties:{},events:{},children:[],toJSON:n};return t.forEach(function(e){"undefined"!=typeof e.id?u.id=e.id:"undefined"!=typeof e.className?u.classes.push(e.className):"undefined"!=typeof e.attr?u.attributes[e.attr]=e.value:"undefined"!=typeof e.prop?u.properties[e.prop]=e.value:"undefined"!=typeof e.event&&("undefined"==typeof u.events[e.event]&&(u.events[e.event]=[]),u.events[e.event].push(e.value))}),"undefined"!=typeof r&&(r.partial.length>0&&(u.partial=r.partial),"undefined"!=typeof r.textnode&&"undefined"!=typeof r.textnode.text&&u.children.push(r.textnode)),u},i.createDirective=function(e,n,r){return{directive:e,expr:n,line:r,children:[],toJSON:t}},i.escapedCharacter=function(e){return e.length>1?String.fromCharCode(parseInt(e,16)):{f:"\f",b:"\b",t:"	",n:"\n",r:"\r"}[e]||e},i}(),t.parser=function(e){var n;return n=function(){function n(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,r){function l(e){var n={};for(var t in e)n[t]=e[t];return n}function u(e,n){for(var r=e.offset+n,l=e.offset;r>l;l++){var u=t.charAt(l);"\n"===u?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===u||"\u2028"===u||"\u2029"===u?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}e.offset+=n}function i(e){L.offset<M.offset||(L.offset>M.offset&&(M=l(L),I=[]),I.push(e))}function o(){var n,t,r,u,i,o,f,c;for(o=l(L),f=l(L),n=[],t=a();null!==t;)n.push(t),t=a();if(null!==n)if(t=s(),t=null!==t?t:"",null!==t){if(r=[],c=l(L),i=a(),null!==i)for(u=[];null!==i;)u.push(i),i=a();else u=null;for(null!==u?(i=s(),null!==i?u=[u,i]:(u=null,L=l(c))):(u=null,L=l(c));null!==u;){if(r.push(u),c=l(L),i=a(),null!==i)for(u=[];null!==i;)u.push(i),i=a();else u=null;null!==u?(i=s(),null!==i?u=[u,i]:(u=null,L=l(c))):(u=null,L=l(c))}if(null!==r){for(u=[],i=a();null!==i;)u.push(i),i=a();null!==u?n=[n,t,r,u]:(n=null,L=l(f))}else n=null,L=l(f)}else n=null,L=l(f);else n=null,L=l(f);return null!==n&&(n=function(n,t,r,l,u){return e.generateNodeTree(l,u)}(o.offset,o.line,o.column,n[1],n[2])),null===n&&(L=l(o)),n}function f(){var e;return H++,/^[ \t]/.test(t.charAt(L.offset))?(e=t.charAt(L.offset),u(L,1)):(e=null,0===H&&i("[ \\t]")),H--,0===H&&null===e&&i("whitespace"),e}function s(){var e,n,t,r,u,i;if(u=l(L),i=l(L),e=c(),null!==e)if(n=w(),null===n&&(n=S(),null===n&&(n=F())),null!==n){for(t=[],r=f();null!==r;)t.push(r),r=f();null!==t?e=[e,n,t]:(e=null,L=l(i))}else e=null,L=l(i);else e=null,L=l(i);return null!==e&&(e=function(e,n,t,r,l){return{indent:r,item:l,num:n}}(u.offset,u.line,u.column,e[0],e[1])),null===e&&(L=l(u)),e}function c(){var n,t,r;for(H++,r=l(L),n=[],t=f();null!==t;)n.push(t),t=f();return null!==n&&(n=function(n,t,r,l){return e.parseIndent(J,l,t)}(r.offset,r.line,r.column,n)),null===n&&(L=l(r)),H--,0===H&&null===n&&i("indent"),n}function a(){var e;return H++,10===t.charCodeAt(L.offset)?(e="\n",u(L,1)):(e=null,0===H&&i('"\\n"')),H--,0===H&&null===e&&i("new line"),e}function d(){var e;return H++,/^[^\n]/.test(t.charAt(L.offset))?(e=t.charAt(L.offset),u(L,1)):(e=null,0===H&&i("[^\\n]")),H--,0===H&&null===e&&i("character"),e}function p(){var e,n,r,o,f;if(H++,o=l(L),f=l(L),/^[a-z_]/i.test(t.charAt(L.offset))?(e=t.charAt(L.offset),u(L,1)):(e=null,0===H&&i("[a-z_]i")),null!==e){for(n=[],/^[a-z0-9_\-]/i.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i("[a-z0-9_\\-]i"));null!==r;)n.push(r),/^[a-z0-9_\-]/i.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i("[a-z0-9_\\-]i"));null!==n?e=[e,n]:(e=null,L=l(f))}else e=null,L=l(f);return null!==e&&(e=function(e,n,t,r,l){return r+l.join("")}(o.offset,o.line,o.column,e[0],e[1])),null===e&&(L=l(o)),H--,0===H&&null===e&&i("identifier"),e}function h(){var e,n,r,o;return r=l(L),o=l(L),33===t.charCodeAt(L.offset)?(e="!",u(L,1)):(e=null,0===H&&i('"!"')),null!==e?(n=p(),null!==n?e=[e,n]:(e=null,L=l(o))):(e=null,L=l(o)),null!==e&&(e=function(e,n,t,r){return r}(r.offset,r.line,r.column,e[1])),null===e&&(L=l(r)),e}function v(){var e,n,r,o;return r=l(L),o=l(L),35===t.charCodeAt(L.offset)?(e="#",u(L,1)):(e=null,0===H&&i('"#"')),null!==e?(n=p(),null!==n?e=[e,n]:(e=null,L=l(o))):(e=null,L=l(o)),null!==e&&(e=function(e,n,t,r){return{id:r}}(r.offset,r.line,r.column,e[1])),null===e&&(L=l(r)),e}function m(){var e,n,r,o;return r=l(L),o=l(L),46===t.charCodeAt(L.offset)?(e=".",u(L,1)):(e=null,0===H&&i('"."')),null!==e?(n=p(),null!==n?e=[e,n]:(e=null,L=l(o))):(e=null,L=l(o)),null!==e&&(e=function(e,n,t,r){return{className:r}}(r.offset,r.line,r.column,e[1])),null===e&&(L=l(r)),e}function g(){var e,n,r;for(r=l(L),e=[],n=k(),null===n&&(/^[^\\\n\]]/.test(t.charAt(L.offset))?(n=t.charAt(L.offset),u(L,1)):(n=null,0===H&&i("[^\\\\\\n\\]]")));null!==n;)e.push(n),n=k(),null===n&&(/^[^\\\n\]]/.test(t.charAt(L.offset))?(n=t.charAt(L.offset),u(L,1)):(n=null,0===H&&i("[^\\\\\\n\\]]")));return null!==e&&(e=function(e,n,t,r){return r.join("")}(r.offset,r.line,r.column,e)),null===e&&(L=l(r)),e}function y(){var e,n,r,o,f,s,c;return s=l(L),c=l(L),91===t.charCodeAt(L.offset)?(e="[",u(L,1)):(e=null,0===H&&i('"["')),null!==e?(n=p(),null!==n?(61===t.charCodeAt(L.offset)?(r="=",u(L,1)):(r=null,0===H&&i('"="')),null!==r?(o=g(),null!==o?(93===t.charCodeAt(L.offset)?(f="]",u(L,1)):(f=null,0===H&&i('"]"')),null!==f?e=[e,n,r,o,f]:(e=null,L=l(c))):(e=null,L=l(c))):(e=null,L=l(c))):(e=null,L=l(c))):(e=null,L=l(c)),null!==e&&(e=function(e,n,t,r,l){return{attr:r,value:l}}(s.offset,s.line,s.column,e[1],e[3])),null===e&&(L=l(s)),e}function x(){var e,n,r,o,f,s,c,a;return c=l(L),a=l(L),91===t.charCodeAt(L.offset)?(e="[",u(L,1)):(e=null,0===H&&i('"["')),null!==e?(46===t.charCodeAt(L.offset)?(n=".",u(L,1)):(n=null,0===H&&i('"."')),null!==n?(r=p(),null!==r?(61===t.charCodeAt(L.offset)?(o="=",u(L,1)):(o=null,0===H&&i('"="')),null!==o?(f=g(),null!==f?(93===t.charCodeAt(L.offset)?(s="]",u(L,1)):(s=null,0===H&&i('"]"')),null!==s?e=[e,n,r,o,f,s]:(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a)),null!==e&&(e=function(e,n,t,r,l){return{prop:r,value:l}}(c.offset,c.line,c.column,e[2],e[4])),null===e&&(L=l(c)),e}function A(){var e,n,r,o,f,s,c,a;return c=l(L),a=l(L),91===t.charCodeAt(L.offset)?(e="[",u(L,1)):(e=null,0===H&&i('"["')),null!==e?(33===t.charCodeAt(L.offset)?(n="!",u(L,1)):(n=null,0===H&&i('"!"')),null!==n?(r=p(),null!==r?(61===t.charCodeAt(L.offset)?(o="=",u(L,1)):(o=null,0===H&&i('"="')),null!==o?(f=g(),null!==f?(93===t.charCodeAt(L.offset)?(s="]",u(L,1)):(s=null,0===H&&i('"]"')),null!==s?e=[e,n,r,o,f,s]:(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a))):(e=null,L=l(a)),null!==e&&(e=function(e,n,t,r,l){return{event:r,value:l}}(c.offset,c.line,c.column,e[2],e[4])),null===e&&(L=l(c)),e}function C(){var e;return H++,e=v(),null===e&&(e=m(),null===e&&(e=y(),null===e&&(e=x(),null===e&&(e=A())))),H--,0===H&&null===e&&i("element qualifier"),e}function w(){var e;return H++,e=E(),null===e&&(e=_()),H--,0===H&&null===e&&i("element"),e}function E(){var n,t,r,u;if(r=l(L),u=l(L),t=C(),null!==t)for(n=[];null!==t;)n.push(t),t=C();else n=null;return null!==n?(t=N(),null!==t?n=[n,t]:(n=null,L=l(u))):(n=null,L=l(u)),null!==n&&(n=function(n,t,r,l,u){return e.createElement("div",l,u,t)}(r.offset,r.line,r.column,n[0],n[1])),null===n&&(L=l(r)),n}function _(){var n,t,r,u,i;if(u=l(L),i=l(L),n=p(),null!==n){for(t=[],r=C();null!==r;)t.push(r),r=C();null!==t?(r=N(),null!==r?n=[n,t,r]:(n=null,L=l(i))):(n=null,L=l(i))}else n=null,L=l(i);return null!==n&&(n=function(n,t,r,l,u,i){return e.createElement(l,u,i,t)}(u.offset,u.line,u.column,n[0],n[1],n[2])),null===n&&(L=l(u)),n}function N(){var e,n,t,r,u,i,o;if(r=l(L),u=l(L),i=l(L),o=l(L),n=f(),null!==n)for(e=[];null!==n;)e.push(n),n=f();else e=null;if(null!==e?(n=S(),null!==n?e=[e,n]:(e=null,L=l(o))):(e=null,L=l(o)),null!==e&&(e=function(e,n,t,r){return r}(i.offset,i.line,i.column,e[1])),null===e&&(L=l(i)),e=null!==e?e:"",null!==e){if(i=l(L),o=l(L),t=f(),null!==t)for(n=[];null!==t;)n.push(t),t=f();else n=null;null!==n?(t=h(),null!==t?n=[n,t]:(n=null,L=l(o))):(n=null,L=l(o)),null!==n&&(n=function(e,n,t,r){return r}(i.offset,i.line,i.column,n[1])),null===n&&(L=l(i)),n=null!==n?n:"",null!==n?e=[e,n]:(e=null,L=l(u))}else e=null,L=l(u);return null!==e&&(e=function(e,n,t,r,l){return{textnode:r,partial:l}}(r.offset,r.line,r.column,e[0],e[1])),null===e&&(L=l(r)),e}function S(){var n,t;return H++,t=l(L),n=z(),null!==n&&(n=function(n,t,r,l){return e.createTextNode(l,t)}(t.offset,t.line,t.column,n)),null===n&&(L=l(t)),H--,0===H&&null===n&&i("text node"),n}function b(){var e,n,r,o,f,s,c;return s=l(L),c=l(L),117===t.charCodeAt(L.offset)?(e="u",u(L,1)):(e=null,0===H&&i('"u"')),null!==e?(/^[0-9a-z]/i.test(t.charAt(L.offset))?(n=t.charAt(L.offset),u(L,1)):(n=null,0===H&&i("[0-9a-z]i")),null!==n?(/^[0-9a-z]/i.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i("[0-9a-z]i")),null!==r?(/^[0-9a-z]/i.test(t.charAt(L.offset))?(o=t.charAt(L.offset),u(L,1)):(o=null,0===H&&i("[0-9a-z]i")),null!==o?(/^[0-9a-z]/i.test(t.charAt(L.offset))?(f=t.charAt(L.offset),u(L,1)):(f=null,0===H&&i("[0-9a-z]i")),null!==f?e=[e,n,r,o,f]:(e=null,L=l(c))):(e=null,L=l(c))):(e=null,L=l(c))):(e=null,L=l(c))):(e=null,L=l(c)),null!==e&&(e=function(e,n,t,r,l,u,i){return""+r+l+u+i}(s.offset,s.line,s.column,e[1],e[2],e[3],e[4])),null===e&&(L=l(s)),e}function T(){var e,n,r,o,f;return o=l(L),f=l(L),120===t.charCodeAt(L.offset)?(e="x",u(L,1)):(e=null,0===H&&i('"x"')),null!==e?(/^[0-9a-z]/i.test(t.charAt(L.offset))?(n=t.charAt(L.offset),u(L,1)):(n=null,0===H&&i("[0-9a-z]i")),null!==n?(/^[0-9a-z]/i.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i("[0-9a-z]i")),null!==r?e=[e,n,r]:(e=null,L=l(f))):(e=null,L=l(f))):(e=null,L=l(f)),null!==e&&(e=function(e,n,t,r,l){return""+r+l}(o.offset,o.line,o.column,e[1],e[2])),null===e&&(L=l(o)),e}function k(){var n,r,o,f;return o=l(L),f=l(L),92===t.charCodeAt(L.offset)?(n="\\",u(L,1)):(n=null,0===H&&i('"\\\\"')),null!==n?(r=b(),null===r&&(r=T(),null===r&&(r=d())),null!==r?n=[n,r]:(n=null,L=l(f))):(n=null,L=l(f)),null!==n&&(n=function(n,t,r,l){return e.escapedCharacter(l)}(o.offset,o.line,o.column,n[1])),null===n&&(L=l(o)),n}function j(){var e,n,r,o,f;if(o=l(L),f=l(L),34===t.charCodeAt(L.offset)?(e='"',u(L,1)):(e=null,0===H&&i('"\\""')),null!==e){for(n=[],r=k(),null===r&&(/^[^\\\n"]/.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i('[^\\\\\\n"]')));null!==r;)n.push(r),r=k(),null===r&&(/^[^\\\n"]/.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i('[^\\\\\\n"]')));null!==n?(34===t.charCodeAt(L.offset)?(r='"',u(L,1)):(r=null,0===H&&i('"\\""')),null!==r?e=[e,n,r]:(e=null,L=l(f))):(e=null,L=l(f))}else e=null,L=l(f);return null!==e&&(e=function(e,n,t,r){return r.join("")}(o.offset,o.line,o.column,e[1])),null===e&&(L=l(o)),e}function O(){var e,n,r,o,f;if(o=l(L),f=l(L),39===t.charCodeAt(L.offset)?(e="'",u(L,1)):(e=null,0===H&&i('"\'"')),null!==e){for(n=[],r=k(),null===r&&(/^[^\\\n']/.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i("[^\\\\\\n']")));null!==r;)n.push(r),r=k(),null===r&&(/^[^\\\n']/.test(t.charAt(L.offset))?(r=t.charAt(L.offset),u(L,1)):(r=null,0===H&&i("[^\\\\\\n']")));null!==n?(39===t.charCodeAt(L.offset)?(r="'",u(L,1)):(r=null,0===H&&i('"\'"')),null!==r?e=[e,n,r]:(e=null,L=l(f))):(e=null,L=l(f))}else e=null,L=l(f);return null!==e&&(e=function(e,n,t,r){return r.join("")}(o.offset,o.line,o.column,e[1])),null===e&&(L=l(o)),e}function z(){var e;return H++,e=j(),null===e&&(e=O()),H--,0===H&&null===e&&i("quoted text"),e}function F(){var e;return H++,e=D(),null===e&&(e=R()),H--,0===H&&null===e&&i("directive"),e}function R(){var n,r,o,f;return o=l(L),f=l(L),64===t.charCodeAt(L.offset)?(n="@",u(L,1)):(n=null,0===H&&i('"@"')),null!==n?(r=p(),null!==r?n=[n,r]:(n=null,L=l(f))):(n=null,L=l(f)),null!==n&&(n=function(n,t,r,l){return e.createDirective(l,void 0,t)}(o.offset,o.line,o.column,n[1])),null===n&&(L=l(o)),n}function D(){var n,r,o,s,c,a,h;if(a=l(L),h=l(L),64===t.charCodeAt(L.offset)?(n="@",u(L,1)):(n=null,0===H&&i('"@"')),null!==n)if(r=p(),null!==r){if(s=f(),null!==s)for(o=[];null!==s;)o.push(s),s=f();else o=null;if(null!==o){if(c=d(),null!==c)for(s=[];null!==c;)s.push(c),c=d();else s=null;null!==s?n=[n,r,o,s]:(n=null,L=l(h))}else n=null,L=l(h)}else n=null,L=l(h);else n=null,L=l(h);return null!==n&&(n=function(n,t,r,l,u){return e.createDirective(l,u.join(""),t)}(a.offset,a.line,a.column,n[1],n[3])),null===n&&(L=l(a)),n}function P(e){e.sort();for(var n=null,t=[],r=0;r<e.length;r++)e[r]!==n&&(t.push(e[r]),n=e[r]);return t}var q={templateLines:o,__:f,line:s,indent:c,newline:a,character:d,identifier:p,partial:h,elemId:v,elemClass:m,squareBracketsValue:g,elemAttribute:y,elemProperty:x,elemEventHandler:A,elemQualifier:C,element:w,implicitElement:E,explicitElement:_,elementAdditions:N,textNode:S,escapedUnicode:b,escapedASCII:T,escapedCharacter:k,doubleQuotedText:j,singleQuotedText:O,quotedText:z,directive:F,simpleDirective:R,exprDirective:D};if(void 0!==r){if(void 0===q[r])throw new Error("Invalid rule name: "+n(r)+".")}else r="templateLines";var L={offset:0,line:1,column:1,seenCR:!1},H=0,M={offset:0,line:1,column:1,seenCR:!1},I=[],J=[0],U=q[r]();if(null===U||L.offset!==t.length){var X=Math.max(L.offset,M.offset),B=X<t.length?t.charAt(X):null,$=L.offset>M.offset?L:M;throw new this.SyntaxError(P(I),B,X,$.line,$.column)}return U},toSource:function(){return this._source}};return t.SyntaxError=function(e,t,r,l,u){function i(e,t){var r,l;switch(e.length){case 0:r="end of input";break;case 1:r=e[0];break;default:r=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}return l=t?n(t):"end of input","Expected "+r+" but "+l+" found."}this.name="SyntaxError",this.expected=e,this.found=t,this.message=i(e,t),this.offset=r,this.line=l,this.column=u},t.SyntaxError.prototype=Error.prototype,t}()}(t.parsehelpers),t.preprocessor=function(){var e,n,t=/\r\n|\r|\n/,r=/^[ \t]*$/,l=/\/\*((?:\/(?!<\*)|[^\/])*?)\*\//g;return e=function(e,n){return n.split(t).map(function(){return""}).join("\n")},n=function(e){return e.match(r)?"":e},function(r){return r=r.replace(l,e),r=r.split(t).map(n).join("\n")}}(),t.misc=function(){return{jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\t]/g,"\\t").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},findScript:function(e){var n,t,r,l,u;try{u=document.querySelectorAll("script#"+e)}catch(i){return}if(u)for(n=0,t=u.length;t>n;n++)if(r=u[n],"text/x-ist"===r.getAttribute("type"))return r.innerHTML;return l}}}(),t.amdplugin=function(e,n){function t(t){var r,i,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],f={};if(u)r=function(){var e,n,t;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(n=0;3>n;n++){t=o[n];try{e=new ActiveXObject(t)}catch(r){}if(e){o=[t];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},i=function(e,n){var t=r();t.open("GET",e,!0),t.onreadystatechange=function(){if(4===t.readyState){if(200!==t.status)throw new Error("HTTP status "+t.status+" when loading "+e);n(t.responseText)}},t.send(null)};else if(l){var s=e.nodeRequire("fs");i=function(e,n){var t=s.readFileSync(e,"utf8");0===t.indexOf("﻿")&&(t=t.substring(1)),n(t)}}t.write=function(e,n,t){var r="ist!"+n;if(f.hasOwnProperty(r)){var l=f[r];t(l)}},t.load=function(e,r,l,u){var o,s,c=!0;/!bare$/.test(e)&&(c=!1,e=e.replace(/!bare$/,"")),o=r.toUrl(e+".ist"),s=-1===e.indexOf("/")?".":e.replace(/\/[^\/]*$/,""),i(o,function(i){var a,d=["ist"];i=i.replace(/^(\s*)@include\s+(?:text=)?(['"])((?:(?=(\\?))\4.)*?)\2/gm,function(e,t,r,l){if(n.findScript(l))return e;var u=s+"/"+l.replace(/\.ist$/,"");return-1===d.indexOf("ist!"+u)&&d.push("ist!"+u),t+'@include "'+u+'"'}),c?(a=t(i,e).getCode(!0),i="define('ist!"+e+"',"+JSON.stringify(d)+", function(ist) {\n"+"  return "+a+";\n"+"});\n"):u.isBuild?(i=n.jsEscape(i),i="define('ist!"+e+"',"+JSON.stringify(d)+",function(ist){"+"var template='"+i+"';"+"return ist(template,'"+e+"');"+"});"):(i=n.jsEscape(i).replace(/\\n/g,"\\n' +\n	               '"),i="define('ist!"+e+"',"+JSON.stringify(d)+", function(ist){ \n"+"	var template = '"+i+"';\n"+"	return ist(template, '"+e+"');\n"+"});\n"),u.isBuild&&(f["ist!"+e]=i),u.isBuild||(i+="\r\n//@ sourceURL="+o),l.fromText("ist!"+e,i),r(["ist!"+e],function(e){l(e)})})}}return t}(t.require,t.misc),t.ist=function(e,n,t,i,o,f){function s(n,r){var l;r=r||"<unknown>";try{l=t.parse(i(n))}catch(u){throw u.message+=" in '"+r+"' on line "+u.line+("undefined"!=typeof u.column?", character "+u.column:""),u}return new e(r,l)}return s.Template=e,s.createNode=function(e,n,t){var r,l=e.split(">").map(function(e){return e.trim()}),u="",i="";return l.forEach(function(e){i+="\n"+u+e,u+=" "}),r=s(i).render(n,t),1===r.childNodes.length?r.firstChild:r},s.fromScriptTag=function(e){var n=f.findScript(e);return n?s(n):void 0},s.registerHelper=function(e,t){n.register(e,t)},s.registerHelper("include",function(e,n,t,l){var u,i,o=n.value,c=o.replace(/\.ist$/,"");if(u=f.findScript(o),r)for(i=[c,c+".ist","ist!"+c,"text!"+c+".ist"];!u&&i.length;)try{u=requirejs(i.shift())}catch(a){}if(!u)throw new Error("Cannot find included template '"+o+"'");if("string"==typeof u&&(u=s(u,c)),"function"!=typeof u.render)throw new Error("Invalid included template '"+o+"'");l.appendChild(u.render(e))}),(l||u&&r)&&o(s),s}(t.template,t.directives,t.parser,t.preprocessor,t.amdplugin,t.misc),r?e.define("ist",[],function(){return t.ist}):(n=e.ist,e.ist=t.ist,e.ist.noConflict=function(){var t=e.ist;return e.ist=n,t})}(this);